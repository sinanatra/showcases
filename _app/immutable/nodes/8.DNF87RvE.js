import{s as Ie,n as oe,d as E,F as gt,r as Rt,p as J,b as S,i as D,q as C,G as Re,f as z,h as G,v as Y,t as H,j as B,x as N,w as F,y as ue,o as wt,I as tt,Z as lt,_ as Xe,z as Se,D as ne,X as vt,Y as yt,H as pt}from"../chunks/7zwduY7e.js";import{S as Ne,i as Ue,d as ze,t as de,a as _e,g as kt,c as Et,m as Be,e as Oe,b as xe}from"../chunks/D_8M7GTZ.js";import{c as St}from"../chunks/CKvn6CDR.js";import{b as Ee,h as zt,i as Tt,j as Bt,a as Ot}from"../chunks/Bq54tBkh.js";import{e as Ve}from"../chunks/D6YF6ztN.js";import{a as nt,s as xt,l as Vt,t as Yt,b as Nt}from"../chunks/CesEukfy.js";import{P as Ut}from"../chunks/BP0KYbRm.js";const Xt=!0,_l=Object.freeze(Object.defineProperty({__proto__:null,prerender:Xt},Symbol.toStringTag,{value:"Module"}));function ot(n,e,t){const l=n.slice();return l[17]=e[t],l}function rt(n,e,t){const l=n.slice();return l[20]=e[t],l}function st(n){let e,t=n[20].toUpperCase()+"",l,s,r,i,f;function h(){return n[9](n[20])}return{c(){e=B("button"),l=F(t),s=N(),this.h()},l(w){e=z(w,"BUTTON",{"aria-pressed":!0,class:!0});var c=G(e);l=H(c,t),s=Y(c),c.forEach(E),this.h()},h(){S(e,"aria-pressed",r=n[1]===n[20]),S(e,"class","svelte-cenhhm"),tt(e,"active",n[1]===n[20])},m(w,c){D(w,e,c),C(e,l),C(e,s),i||(f=Re(e,"click",h),i=!0)},p(w,c){n=w,c&2&&r!==(r=n[1]===n[20])&&S(e,"aria-pressed",r),c&2&&tt(e,"active",n[1]===n[20])},d(w){w&&E(e),i=!1,f()}}}function Kt(n){let e=n[4]("controls_report",n[3].length)+"",t;return{c(){t=F(e)},l(l){t=H(l,e)},m(l,s){D(l,t,s)},p(l,s){s&24&&e!==(e=l[4]("controls_report",l[3].length)+"")&&J(t,e)},d(l){l&&E(t)}}}function Ht(n){let e=n[4]("controls_report",1)+"",t;return{c(){t=F(e)},l(l){t=H(l,e)},m(l,s){D(l,t,s)},p(l,s){s&16&&e!==(e=l[4]("controls_report",1)+"")&&J(t,e)},d(l){l&&E(t)}}}function at(n){let e,t=n[2]("controls_mentioning")+"",l,s,r,i,f=n[2]("controls_any")+"",h,w,c,p,u=Ve(n[0]),_=[];for(let v=0;v<u.length;v+=1)_[v]=it(ot(n,u,v));return{c(){e=F(" "),l=F(t),s=N(),r=B("select"),i=B("option"),h=F(f);for(let v=0;v<_.length;v+=1)_[v].c();this.h()},l(v){e=H(v," "),l=H(v,t),s=Y(v),r=z(v,"SELECT",{class:!0});var T=G(r);i=z(T,"OPTION",{});var m=G(i);h=H(m,f),m.forEach(E);for(let P=0;P<_.length;P+=1)_[P].l(T);T.forEach(E),this.h()},h(){i.__value="",Xe(i,i.__value),S(r,"class","svelte-cenhhm")},m(v,T){D(v,e,T),D(v,l,T),D(v,s,T),D(v,r,T),C(r,i),C(i,h);for(let m=0;m<_.length;m+=1)_[m]&&_[m].m(r,null);lt(r,n[5].keyword),c||(p=Re(r,"change",n[10]),c=!0)},p(v,T){if(T&4&&t!==(t=v[2]("controls_mentioning")+"")&&J(l,t),T&4&&f!==(f=v[2]("controls_any")+"")&&J(h,f),T&1){u=Ve(v[0]);let m;for(m=0;m<u.length;m+=1){const P=ot(v,u,m);_[m]?_[m].p(P,T):(_[m]=it(P),_[m].c(),_[m].m(r,null))}for(;m<_.length;m+=1)_[m].d(1);_.length=u.length}T&33&&w!==(w=v[5].keyword)&&lt(r,v[5].keyword)},d(v){v&&(E(e),E(l),E(s),E(r)),gt(_,v),c=!1,p()}}}function it(n){let e,t=n[17].label+"",l,s;return{c(){e=B("option"),l=F(t),this.h()},l(r){e=z(r,"OPTION",{});var i=G(e);l=H(i,t),i.forEach(E),this.h()},h(){e.__value=s=n[17].value,Xe(e,e.__value)},m(r,i){D(r,e,i),C(e,l)},p(r,i){i&1&&t!==(t=r[17].label+"")&&J(l,t),i&1&&s!==(s=r[17].value)&&(e.__value=s,Xe(e,e.__value))},d(r){r&&E(e)}}}function Ft(n){let e,t,l,s=n[2]("controls_showingLast")+"",r,i,f,h=n[3].length+"",w,c,p,u,_=n[2]("controls_containing")+"",v,T,m,P,ce,ve,o=n[2]("controls_or")+"",A,j,k,O,re,Q,$=n[2]("controls_onlyLatest")+"",fe,ye,pe,x=Ve(nt),M=[];for(let g=0;g<x.length;g+=1)M[g]=st(rt(n,x,g));function ke(g,L){return g[3].length===1?Ht:Kt}let he=ke(n),U=he(n),R=n[0].length&&at(n);return{c(){e=B("div");for(let g=0;g<M.length;g+=1)M[g].c();t=N(),l=B("div"),r=F(s),i=N(),f=B("strong"),w=F(h),c=N(),U.c(),p=N(),R&&R.c(),u=N(),v=F(_),T=N(),m=B("input"),ve=N(),A=F(o),j=N(),k=B("label"),O=B("input"),Q=N(),fe=F($),this.h()},l(g){e=z(g,"DIV",{class:!0});var L=G(e);for(let me=0;me<M.length;me+=1)M[me].l(L);L.forEach(E),t=Y(g),l=z(g,"DIV",{class:!0});var d=G(l);r=H(d,s),i=Y(d),f=z(d,"STRONG",{class:!0});var q=G(f);w=H(q,h),q.forEach(E),c=Y(d),U.l(d),p=Y(d),R&&R.l(d),u=Y(d),v=H(d,_),T=Y(d),m=z(d,"INPUT",{type:!0,placeholder:!0,class:!0}),ve=Y(d),A=H(d,o),j=Y(d),k=z(d,"LABEL",{class:!0});var ee=G(k);O=z(ee,"INPUT",{type:!0,class:!0}),Q=Y(ee),fe=H(ee,$),ee.forEach(E),d.forEach(E),this.h()},h(){S(e,"class","lang-switch svelte-cenhhm"),S(f,"class","svelte-cenhhm"),S(m,"type","text"),m.value=P=n[5].text,S(m,"placeholder",ce=n[2]("controls_textPlaceholder")),S(m,"class","inline-input svelte-cenhhm"),S(O,"type","checkbox"),O.checked=re=n[5].showOnlyLatest,S(O,"class","svelte-cenhhm"),S(k,"class","inline-checkbox svelte-cenhhm"),S(l,"class","controls svelte-cenhhm")},m(g,L){D(g,e,L);for(let d=0;d<M.length;d+=1)M[d]&&M[d].m(e,null);D(g,t,L),D(g,l,L),C(l,r),C(l,i),C(l,f),C(f,w),C(l,c),U.m(l,null),C(l,p),R&&R.m(l,null),C(l,u),C(l,v),C(l,T),C(l,m),C(l,ve),C(l,A),C(l,j),C(l,k),C(k,O),C(k,Q),C(k,fe),ye||(pe=[Re(m,"input",n[11]),Re(O,"change",n[12])],ye=!0)},p(g,[L]){if(L&2){x=Ve(nt);let d;for(d=0;d<x.length;d+=1){const q=rt(g,x,d);M[d]?M[d].p(q,L):(M[d]=st(q),M[d].c(),M[d].m(e,null))}for(;d<M.length;d+=1)M[d].d(1);M.length=x.length}L&4&&s!==(s=g[2]("controls_showingLast")+"")&&J(r,s),L&8&&h!==(h=g[3].length+"")&&J(w,h),he===(he=ke(g))&&U?U.p(g,L):(U.d(1),U=he(g),U&&(U.c(),U.m(l,p))),g[0].length?R?R.p(g,L):(R=at(g),R.c(),R.m(l,u)):R&&(R.d(1),R=null),L&4&&_!==(_=g[2]("controls_containing")+"")&&J(v,_),L&33&&P!==(P=g[5].text)&&m.value!==P&&(m.value=P),L&4&&ce!==(ce=g[2]("controls_textPlaceholder"))&&S(m,"placeholder",ce),L&4&&o!==(o=g[2]("controls_or")+"")&&J(A,o),L&33&&re!==(re=g[5].showOnlyLatest)&&(O.checked=re),L&4&&$!==($=g[2]("controls_onlyLatest")+"")&&J(fe,$)},i:oe,o:oe,d(g){g&&(E(e),E(t),E(l)),gt(M,g),U.d(),R&&R.d(),ye=!1,Rt(pe)}}}const Gt=1e4,jt=5e3,Wt=20;function qt(n,e,t){let l,s,r,i,f,h;ue(n,zt,o=>t(0,l=o)),ue(n,Vt,o=>t(1,s=o)),ue(n,Yt,o=>t(2,r=o)),ue(n,Tt,o=>t(3,i=o)),ue(n,Nt,o=>t(4,f=o)),ue(n,Ee,o=>t(5,h=o));let w=Date.now(),c=!1,p=0;function u(){w=Date.now(),c=!1,p=0}function _(o){u(),Ee.update(A=>({...A,keyword:o}))}function v(o){u(),Ee.update(A=>({...A,text:o}))}function T(o){u(),Ee.update(A=>({...A,showOnlyLatest:o}))}return wt(()=>{const o=["mousemove","mousedown","click","keydown","wheel","touchstart","pointermove"];o.forEach(k=>window.addEventListener(k,u,{passive:!0}));let A=0;const j=setInterval(()=>{const k=Date.now()-w;!c&&k>=Gt&&l.length>0&&(c=!0,p=0),c&&l.length>0&&(A=(A+1)%l.length,Ee.update(O=>({...O,keyword:l[A].value})),p++,p>=Wt&&(c=!1))},jt);return()=>{clearInterval(j),o.forEach(k=>window.removeEventListener(k,u))}}),[l,s,r,i,f,h,_,v,T,o=>xt(o),o=>_(o.target.value),o=>v(o.target.value),o=>T(o.target.checked)]}class Zt extends Ne{constructor(e){super(),Ue(this,e,qt,Ft,Ie,{})}}function Ye(n,e){if(!n||!Array.isArray(e)||!e.length)return n;const t=s=>s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),l=new RegExp(e.filter(Boolean).sort((s,r)=>r.length-s.length).map(t).join("|"),"gi");return n.replace(l,s=>`<span class="highlight">${s}</span>`)}function ct(n){let e,t,l,s,r=Ye(n[0],n[5])+"",i,f=n[6]&&ft(n),h=n[1]&&ht(n),w=n[2]&&ut();return{c(){e=B("div"),f&&f.c(),t=N(),h&&h.c(),l=N(),s=new yt(!1),i=N(),w&&w.c(),this.h()},l(c){e=z(c,"DIV",{class:!0,style:!0});var p=G(e);f&&f.l(p),t=Y(p),h&&h.l(p),l=Y(p),s=vt(p,!1),i=Y(p),w&&w.l(p),p.forEach(E),this.h()},h(){s.a=i,S(e,"class","tooltip svelte-102e0u4"),ne(e,"left",n[3]+15+"px"),ne(e,"top",n[4]+"px")},m(c,p){D(c,e,p),f&&f.m(e,null),C(e,t),h&&h.m(e,null),C(e,l),s.m(r,e),C(e,i),w&&w.m(e,null)},p(c,p){c[6]?f?f.p(c,p):(f=ft(c),f.c(),f.m(e,t)):f&&(f.d(1),f=null),c[1]?h?h.p(c,p):(h=ht(c),h.c(),h.m(e,l)):h&&(h.d(1),h=null),p&33&&r!==(r=Ye(c[0],c[5])+"")&&s.p(r),c[2]?w||(w=ut(),w.c(),w.m(e,null)):w&&(w.d(1),w=null),p&8&&ne(e,"left",c[3]+15+"px"),p&16&&ne(e,"top",c[4]+"px")},d(c){c&&E(e),f&&f.d(),h&&h.d(),w&&w.d()}}}function ft(n){let e,t,l;return{c(){e=B("div"),t=B("b"),l=F(n[6]),this.h()},l(s){e=z(s,"DIV",{style:!0});var r=G(e);t=z(r,"B",{});var i=G(t);l=H(i,n[6]),i.forEach(E),r.forEach(E),this.h()},h(){ne(e,"font-size","0.98em"),ne(e,"margin-bottom","0.25em")},m(s,r){D(s,e,r),C(e,t),C(t,l)},p(s,r){r&64&&J(l,s[6])},d(s){s&&E(e)}}}function ht(n){let e,t,l=Ye(n[1],n[5])+"";return{c(){e=B("div"),t=new yt(!1),this.h()},l(s){e=z(s,"DIV",{style:!0});var r=G(e);t=vt(r,!1),r.forEach(E),this.h()},h(){t.a=null,ne(e,"font-size","0.98em"),ne(e,"margin-bottom","0.25em")},m(s,r){D(s,e,r),t.m(l,e)},p(s,r){r&34&&l!==(l=Ye(s[1],s[5])+"")&&t.p(l)},d(s){s&&E(e)}}}function ut(n){let e,t="[Press <kbd>space</kbd> to open link]";return{c(){e=B("div"),e.innerHTML=t,this.h()},l(l){e=z(l,"DIV",{style:!0,"data-svelte-h":!0}),pt(e)!=="svelte-17k9t9i"&&(e.innerHTML=t),this.h()},h(){ne(e,"font-size","0.92em"),ne(e,"margin-top","0.5em")},m(l,s){D(l,e,s)},d(l){l&&E(e)}}}function Jt(n){let e,t=n[0]&&ct(n);return{c(){t&&t.c(),e=Se()},l(l){t&&t.l(l),e=Se()},m(l,s){t&&t.m(l,s),D(l,e,s)},p(l,[s]){l[0]?t?t.p(l,s):(t=ct(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:oe,o:oe,d(l){l&&E(e),t&&t.d(l)}}}function Qt(n,e,t){let{hoveredText:l=""}=e,{hoveredTitle:s=""}=e,{hoveredUrl:r=""}=e,{tooltipX:i=0}=e,{tooltipY:f=0}=e,{keywords:h=[]}=e,{date:w=""}=e;return n.$$set=c=>{"hoveredText"in c&&t(0,l=c.hoveredText),"hoveredTitle"in c&&t(1,s=c.hoveredTitle),"hoveredUrl"in c&&t(2,r=c.hoveredUrl),"tooltipX"in c&&t(3,i=c.tooltipX),"tooltipY"in c&&t(4,f=c.tooltipY),"keywords"in c&&t(5,h=c.keywords),"date"in c&&t(6,w=c.date)},[l,s,r,i,f,h,w]}class $t extends Ne{constructor(e){super(),Ue(this,e,Qt,Jt,Ie,{hoveredText:0,hoveredTitle:1,hoveredUrl:2,tooltipX:3,tooltipY:4,keywords:5,date:6})}}function el(n){let e,t="...";return{c(){e=B("div"),e.textContent=t,this.h()},l(l){e=z(l,"DIV",{class:!0,"data-svelte-h":!0}),pt(e)!=="svelte-91c2k6"&&(e.textContent=t),this.h()},h(){S(e,"class","empty-state svelte-1rfl4nz")},m(l,s){D(l,e,s)},p:oe,i:oe,o:oe,d(l){l&&E(e)}}}function tl(n){let e=n[8],t,l,s=dt(n);return{c(){s.c(),t=Se()},l(r){s.l(r),t=Se()},m(r,i){s.m(r,i),D(r,t,i),l=!0},p(r,i){i&256&&Ie(e,e=r[8])?(kt(),de(s,1,1,oe),Et(),s=dt(r),s.c(),_e(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(_e(s),l=!0)},o(r){de(s),l=!1},d(r){r&&E(t),s.d(r)}}}function dt(n){let e,t;return e=new Ut({props:{sketch:n[9],style:"position:absolute; top:0; left:0;"}}),{c(){xe(e.$$.fragment)},l(l){Oe(e.$$.fragment,l)},m(l,s){Be(e,l,s),t=!0},p:oe,i(l){t||(_e(e.$$.fragment,l),t=!0)},o(l){de(e.$$.fragment,l),t=!1},d(l){ze(e,l)}}}function ll(n){var c,p;let e,t,l,s,r,i;const f=[tl,el],h=[];function w(u,_){return u[0].length?0:1}return t=w(n),l=h[t]=f[t](n),r=new $t({props:{hoveredText:n[1],hoveredTitle:n[3],hoveredUrl:n[2],tooltipX:n[4],tooltipY:n[5],keywords:n[7].length?n[7]:((c=n[6])==null?void 0:c.keywords)||[],date:((p=n[6])==null?void 0:p.date)||""}}),{c(){e=B("div"),l.c(),s=N(),xe(r.$$.fragment),this.h()},l(u){e=z(u,"DIV",{class:!0});var _=G(e);l.l(_),_.forEach(E),s=Y(u),Oe(r.$$.fragment,u),this.h()},h(){S(e,"class","viz-container svelte-1rfl4nz")},m(u,_){D(u,e,_),h[t].m(e,null),D(u,s,_),Be(r,u,_),i=!0},p(u,[_]){var m,P;let v=t;t=w(u),t===v?h[t].p(u,_):(kt(),de(h[v],1,1,()=>{h[v]=null}),Et(),l=h[t],l?l.p(u,_):(l=h[t]=f[t](u),l.c()),_e(l,1),l.m(e,null));const T={};_&2&&(T.hoveredText=u[1]),_&8&&(T.hoveredTitle=u[3]),_&4&&(T.hoveredUrl=u[2]),_&16&&(T.tooltipX=u[4]),_&32&&(T.tooltipY=u[5]),_&192&&(T.keywords=u[7].length?u[7]:((m=u[6])==null?void 0:m.keywords)||[]),_&64&&(T.date=((P=u[6])==null?void 0:P.date)||""),r.$set(T)},i(u){i||(_e(l),_e(r.$$.fragment,u),i=!0)},o(u){de(l),de(r.$$.fragment,u),i=!1},d(u){u&&(E(e),E(s)),h[t].d(),ze(r,u)}}}function _t(n,e=300){if(!n)return"";if(n.length<=e)return n;let t=n.lastIndexOf(" ",e);return t===-1&&(t=e),n.slice(0,t)+"…"}function mt(n,e,t=200){if(!n)return"";const l=String(e||"").trim();if(!l)return _t(n,t);const s=n.toLowerCase().indexOf(l.toLowerCase());if(s===-1)return _t(n,t);let r=Math.max(0,s-Math.floor((t-l.length)/2)),i=r+t;if(i>n.length&&(i=n.length,r=Math.max(0,i-t)),r>0){const h=n.lastIndexOf(" ",r);h!==-1&&(r=h+1)}if(i<n.length){const h=n.indexOf(" ",i);h!==-1&&(i=h)}let f=n.slice(r,i);return r>0&&(f="…"+f),i<n.length&&(f=f+"…"),f}function nl(n,e,t){let l,s,r,i,f;ue(n,Tt,o=>t(0,i=o)),ue(n,Ee,o=>t(12,f=o));const h={fungal:{branchingChance:.29,directionRandomness:2,branchAngle:Math.PI/1.4,downwardBias:.01},chaos:{branchingChance:2,directionRandomness:7,branchAngle:Math.PI/1.4,downwardBias:.01},covid:{branchingChance:10,directionRandomness:200,branchAngle:Math.PI/1.4,downwardBias:.01}},w=Object.keys(h);let c="chaos",p="",u="",_="",v=0,T=0,m=null;function P(o,A,j,k,O=[],re="",Q=""){t(1,p=o||""),t(2,u=A||""),t(3,_=Q||""),t(4,v=j||0),t(5,T=k||0),t(6,m={keywords:O||[],date:re})}function ce(o,A){const j=(f.text||"").trim();return j||(f.keyword?f.keyword:A||"")}let ve=o=>{const A=i,j=()=>h[c]||h.fungal,k=.75,O=8*k,re=12*k,Q=100*k,$=8*k,fe=new Map,ye={};let pe=[],x={x:0,y:0},M=.8,ke=!1,he=0,U=0,R=0,g={x:0,y:0},L={left:0,right:0,top:0,bottom:0},d,q=new Map,ee=[],me=!0;function bt(a,y,b){const K=`${a}_${y}_${b}`;if(fe.has(K))return fe.get(K);const I=o.createGraphics(40*k,40*k);I.colorMode(o.HSB),I.textFont("courier"),I.textAlign(o.CENTER,o.CENTER),I.textSize(b);const V=Math.max(I.textWidth(y),4);return I.noStroke(),I.fill(ye[a]||o.color(0,0,75)),I.rectMode(o.CENTER),I.rect(I.width/2,I.height/2,V+4,b+4),I.fill(0,0,0),I.text(y,I.width/2,I.height/2),fe.set(K,I),I}function Mt(a,y){const b=j();let K=a.dir0.copy();K.y+=b.downwardBias,K.normalize();let I=o.noise(y.x*.01*k,y.y*.01*k,R*.05);const V=1;return K.rotate(o.map(I,0,1,-b.directionRandomness*V,b.directionRandomness*V)),K}function Ct(a,y,b){var W,ae,Te,be,Me,Ae,De,Ce,Le,Ke,He,Fe,Ge,je,We,qe;const K=y/2,I=b/2,V=Array.from(new Set(a.flatMap(X=>Array.isArray(X.KeywordMatch)?X.KeywordMatch:[])));V.forEach((X,Pe)=>{ye[X]=o.color(0,0,55+Pe*120/Math.max(V.length-1,1))});const ge=[];if(!a.length)return ge;const te=((ae=(W=a[0])==null?void 0:W.KeywordMatch)==null?void 0:ae[0])||"",se=((Te=a[0])==null?void 0:Te.Text)??((be=a[0])==null?void 0:be.sentence)??"",le=ce(se,te),Z=mt(se,le);ge.push({kw:te,nodes:[o.createVector(K,I)],sentence:Z,url:((Me=a[0])==null?void 0:Me.URL)||"",date:((Ae=a[0])==null?void 0:Ae.ExtractedDate)||((De=a[0])==null?void 0:De.Date)||"",title:((Ce=a[0])==null?void 0:Ce.Title)||"",maxSteps:Math.ceil(Z.length*($/O)),grown:0,frameCount:0,dir0:o.createVector(0,-1).normalize(),pathLength:0,distArr:[0],lastPlacedCharIndex:-1,finished:!1,parent:null,attachAt:0});for(let X=1;X<a.length;X++){let Pe=Math.floor(Math.random()*Math.max(1,X)),ie=ge[Pe];const Ze=Math.max(3,ie.nodes.length-3);let we=Math.max(1,Math.min(Math.floor(2+Math.random()*(Ze-2)),Ze-1));const At=ie.nodes[we]||ie.nodes[ie.nodes.length-1];let Je=ie.nodes[we+1]?o.createVector(ie.nodes[we+1].x-ie.nodes[we].x,ie.nodes[we+1].y-ie.nodes[we].y).normalize():o.createVector(0,-1),Dt=(Math.random()-.5)*Math.PI/1.2;Je.rotate(Dt);const Qe=((Ke=(Le=a[X])==null?void 0:Le.KeywordMatch)==null?void 0:Ke[0])||"",$e=((He=a[X])==null?void 0:He.Text)??((Fe=a[X])==null?void 0:Fe.sentence)??"",Pt=ce($e,Qe),et=mt($e,Pt);ge.push({kw:Qe,nodes:[At.copy()],sentence:et,url:((Ge=a[X])==null?void 0:Ge.URL)||"",date:((je=a[X])==null?void 0:je.ExtractedDate)||((We=a[X])==null?void 0:We.Date)||"",title:((qe=a[X])==null?void 0:qe.Title)||"",maxSteps:Math.ceil(et.length*($/O)),grown:0,frameCount:0,dir0:Je,pathLength:0,distArr:[0],lastPlacedCharIndex:-1,finished:!1,parent:Pe,attachAt:we})}return ge}function Lt(a,y){return{x:(a-o.width/2)/M-x.x+g.x,y:(y-o.height/2)/M-x.y+g.y}}function It(a,y){return{x:(a-g.x+x.x)*M+o.width/2,y:(y-g.y+x.y)*M+o.height/2}}o.setup=()=>{if(o.createCanvas(window.innerWidth,window.innerHeight),o.colorMode(o.HSB),o.textAlign(o.CENTER,o.CENTER),o.textSize(9*k),o.frameRate(30),!A||!A.length){d=null,ee=[];return}const a=4200*k,y=4200*k;g={x:a/2,y:y/2},L={left:0,right:a,top:0,bottom:y},d=o.createGraphics(a,y),d.colorMode(o.HSB),d.textAlign(o.CENTER,o.CENTER),d.textFont("courier"),d.textSize(13*k),pe=Ct(A,a,y),x={x:0,y:0},R=0,ee=[],me=!0},o.draw=()=>{if(!d){o.background(0);return}q=new Map,pe.forEach(a=>a.nodes.forEach(y=>{if(!y)return;const b=`${Math.floor(y.x/Q)},${Math.floor(y.y/Q)}`;q.has(b)||q.set(b,[]),q.get(b).push(y)})),pe.forEach(a=>{if(a.finished||(a.frameCount++,a.frameCount%1!==0||a.grown>=a.maxSteps))return;const y=a.nodes&&a.nodes[a.nodes.length-1];if(!y)return;let b=Mt(a,y);const[K,I]=[Math.floor(y.x/Q),Math.floor(y.y/Q)];for(let se=-1;se<=1;se++)for(let le=-1;le<=1;le++)(q.get(`${K+se},${I+le}`)||[]).forEach(Z=>{if(!Z)return;const W=y.dist(Z);W>0&&W<re&&b.add(o.createVector(y.x-Z.x,y.y-Z.y).normalize().mult(.6*k))});b.normalize();const V=o.Vector.add(y,o.Vector.mult(b,O));V.x=o.constrain(V.x,L.left+10*k,L.right-10*k),V.y=o.constrain(V.y,L.top+10*k,L.bottom-10*k),a.nodes.push(V),a.grown++;const ge=y.dist(V);a.pathLength+=ge,a.distArr.push(a.pathLength);let te=a.lastPlacedCharIndex+1;for(;te<a.sentence.length&&(te+.5)*$<a.pathLength;){const se=(te+.5)*$,le=a.distArr.findIndex(Z=>Z>=se);if(le>0){const Z=a.distArr[le-1],W=a.nodes[le-1],ae=a.nodes[le];if(!W||!ae)break;const Te=(se-Z)/ae.dist(W),be=o.lerp(W.x,ae.x,Te),Me=o.lerp(W.y,ae.y,Te),Ae=o.atan2(ae.y-W.y,ae.x-W.x),De=a.sentence[te],Ce=re/1.2,Le=bt(a.kw,De,Ce);Le&&(d.push(),d.translate(be,Me),d.rotate(Ae),d.imageMode(o.CENTER),d.image(Le,0,-6),d.pop()),a.lastPlacedCharIndex<te&&ee.push({worldX:be,worldY:Me,radius:Ce*2,url:a.url||"",text:a.sentence,keywords:[a.kw],date:a.date,title:a.title}),a.lastPlacedCharIndex=te,te++}else break}a.grown>=a.maxSteps&&(a.finished=!0)}),R++,o.background(0),o.push(),o.translate(o.width/2,o.height/2),o.scale(M),o.translate(x.x,x.y),o.image(d,-g.x,-g.y),o.pop(),me&&ee.length>0&&(me=!1,setTimeout(()=>{typeof o.mouseMoved=="function"&&o.mouseMoved()},0))},o.mousePressed=()=>{ke=!0,he=o.mouseX,U=o.mouseY},o.mouseReleased=()=>{ke=!1},o.mouseDragged=()=>{if(!ke)return;const a=(o.mouseX-he)/M,y=(o.mouseY-U)/M;x.x+=a,x.y+=y,he=o.mouseX,U=o.mouseY},o.mouseWheel=a=>{const y=a.deltaY<0?1.05:.9523809523809523;return M=o.constrain(M*y,.5,2),!1},o.windowResized=()=>{o.resizeCanvas(window.innerWidth,window.innerHeight)},o.mouseOut=()=>P("","",0,0,[]),o.mouseMoved=()=>{const{x:a,y}=Lt(o.mouseX,o.mouseY);t(6,m=null);for(let b of ee)if(o.dist(a,y,b.worldX,b.worldY)<b.radius){const{x:K,y:I}=It(b.worldX,b.worldY),V=s.length>0?s:b.keywords||[];P(b.text,b.url,K,I-22,V,b.date,b.title),t(6,m=b);break}m||P("","",0,0,[])},o.keyPressed=()=>{if((o.key===" "||o.keyCode===32)&&(m!=null&&m.url))return window.open(m.url,"_blank"),!1}};return n.$$.update=()=>{n.$$.dirty&1&&t(11,l=i.map(o=>`${o.URL||""}|${o.ExtractedDate||o.Date||""}`).join("§")),n.$$.dirty&4096&&t(7,s=[...f.keyword?Bt(f.keyword):[],...f.text?[f.text]:[]].filter(Boolean)),n.$$.dirty&2048&&l&&t(10,c=w[Math.floor(Math.random()*w.length)]),n.$$.dirty&7168&&t(8,r=`${l}|${c}|${f.showOnlyLatest?"1":"0"}|kw:${f.keyword}|q:${f.text}`)},[i,p,u,_,v,T,m,s,r,ve,c,l,f]}class ol extends Ne{constructor(e){super(),Ue(this,e,nl,ll,Ie,{})}}function rl(n){let e,t,l,s;return e=new Zt({}),l=new ol({}),{c(){xe(e.$$.fragment),t=N(),xe(l.$$.fragment)},l(r){Oe(e.$$.fragment,r),t=Y(r),Oe(l.$$.fragment,r)},m(r,i){Be(e,r,i),D(r,t,i),Be(l,r,i),s=!0},p:oe,i(r){s||(_e(e.$$.fragment,r),_e(l.$$.fragment,r),s=!0)},o(r){de(e.$$.fragment,r),de(l.$$.fragment,r),s=!1},d(r){r&&E(t),ze(e,r),ze(l,r)}}}function sl(n){return wt(async()=>{const e=await St("all_merged.csv");Ot.set(e.map(t=>({...t,KeywordMatch:typeof t.KeywordMatch=="string"?t.KeywordMatch.replace(/[\[\]'"]/g,"").split(/[,;]/).map(l=>l.trim()).filter(Boolean):[],Text:t.Text||"",URL:t.URL||"",Title:t.Title||"",ExtractedGender:Array.isArray(t.ExtractedGender)?t.ExtractedGender:t.ExtractedGender?[t.ExtractedGender]:[],ExtractedTime:Array.isArray(t.ExtractedTime)?t.ExtractedTime:t.ExtractedTime?[t.ExtractedTime]:[]})))}),[]}class ml extends Ne{constructor(e){super(),Ue(this,e,sl,rl,Ie,{})}}export{ml as component,_l as universal};
